/* */ 
"use strict";
var __extends = (this && this.__extends) || function(d, b) {
  for (var p in b)
    if (b.hasOwnProperty(p))
      d[p] = b[p];
  function __() {
    this.constructor = d;
  }
  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var OuterSubscriber_1 = require('../OuterSubscriber');
var subscribeToResult_1 = require('../util/subscribeToResult');
function distinct(compare, flushes) {
  return this.lift(new DistinctOperator(compare, flushes));
}
exports.distinct = distinct;
var DistinctOperator = (function() {
  function DistinctOperator(compare, flushes) {
    this.compare = compare;
    this.flushes = flushes;
  }
  DistinctOperator.prototype.call = function(subscriber, source) {
    return source._subscribe(new DistinctSubscriber(subscriber, this.compare, this.flushes));
  };
  return DistinctOperator;
}());
var DistinctSubscriber = (function(_super) {
  __extends(DistinctSubscriber, _super);
  function DistinctSubscriber(destination, compare, flushes) {
    _super.call(this, destination);
    this.values = [];
    if (typeof compare === 'function') {
      this.compare = compare;
    }
    if (flushes) {
      this.add(subscribeToResult_1.subscribeToResult(this, flushes));
    }
  }
  DistinctSubscriber.prototype.notifyNext = function(outerValue, innerValue, outerIndex, innerIndex, innerSub) {
    this.values.length = 0;
  };
  DistinctSubscriber.prototype.notifyError = function(error, innerSub) {
    this._error(error);
  };
  DistinctSubscriber.prototype._next = function(value) {
    var found = false;
    var values = this.values;
    var len = values.length;
    try {
      for (var i = 0; i < len; i++) {
        if (this.compare(values[i], value)) {
          found = true;
          return;
        }
      }
    } catch (err) {
      this.destination.error(err);
      return;
    }
    this.values.push(value);
    this.destination.next(value);
  };
  DistinctSubscriber.prototype.compare = function(x, y) {
    return x === y;
  };
  return DistinctSubscriber;
}(OuterSubscriber_1.OuterSubscriber));
exports.DistinctSubscriber = DistinctSubscriber;
